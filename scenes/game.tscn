[gd_scene load_steps=17 format=3 uid="uid://dm2gjidl1pws5"]

[ext_resource type="Script" path="res://scripts/game.gd" id="1_ml3fd"]
[ext_resource type="FontFile" uid="uid://bu0a23vdmliiy" path="res://media/fonts/CastlevaniaNES.otf" id="2_3e0pq"]
[ext_resource type="Script" path="res://scripts/score_counter.gd" id="3_4f751"]
[ext_resource type="Texture2D" uid="uid://cv105gtfxn6u3" path="res://media/graphics/player_healthbar.png" id="3_a2qj5"]
[ext_resource type="Script" path="res://scripts/stage_label.gd" id="3_wcg8v"]
[ext_resource type="Script" path="res://scripts/health_bar.gd" id="4_hyd55"]
[ext_resource type="Script" path="res://scripts/time_label.gd" id="4_olqpy"]
[ext_resource type="Texture2D" uid="uid://b17wp7eu76yir" path="res://media/graphics/empty_healthbar.png" id="4_ux4al"]
[ext_resource type="Texture2D" uid="uid://bg1cam8shkxe1" path="res://media/graphics/enemy_healthbar.png" id="5_ip3yo"]
[ext_resource type="Texture2D" uid="uid://be4ayy6v0com6" path="res://media/graphics/subweapon_container.png" id="6_qm5vt"]
[ext_resource type="Texture2D" uid="uid://hfqx1mlweo18" path="res://media/graphics/heart_icon.png" id="7_5hip0"]
[ext_resource type="Texture2D" uid="uid://bvblnkatwynwr" path="res://media/graphics/holy_water_icon.png" id="7_l4l51"]
[ext_resource type="Script" path="res://scripts/hearts_counter.gd" id="13_plm4k"]
[ext_resource type="Script" path="res://scripts/lives_label.gd" id="14_5i80s"]
[ext_resource type="PackedScene" uid="uid://b8a8fl14ivr47" path="res://scenes/game_over.tscn" id="15_jld33"]

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_n2ieu"]
content_margin_top = 3.0
bg_color = Color(0, 0, 0, 1)

[node name="Game" type="Node2D"]
script = ExtResource("1_ml3fd")

[node name="GUI" type="CanvasLayer" parent="."]

[node name="GlitchFix" type="ColorRect" parent="GUI"]
offset_right = 40.0
offset_bottom = 40.0
color = Color(1, 1, 1, 0)

[node name="Blackout" type="ColorRect" parent="GUI"]
process_mode = 3
visible = false
offset_right = 384.0
offset_bottom = 216.0
color = Color(0, 0, 0, 1)

[node name="PanelContainer" type="PanelContainer" parent="GUI"]
offset_right = 384.0
offset_bottom = 35.0
theme_override_styles/panel = SubResource("StyleBoxFlat_n2ieu")

[node name="VBoxContainer" type="VBoxContainer" parent="GUI/PanelContainer"]
layout_mode = 2
theme_override_constants/separation = 0

[node name="HBoxContainer" type="HBoxContainer" parent="GUI/PanelContainer/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 0
alignment = 1

[node name="Score" type="Label" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer"]
layout_mode = 2
theme_override_fonts/font = ExtResource("2_3e0pq")
theme_override_font_sizes/font_size = 16
text = "SCORE-000000"
max_lines_visible = 1
script = ExtResource("3_4f751")

[node name="Spacer" type="Control" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3

[node name="Time" type="Label" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer"]
layout_mode = 2
theme_override_fonts/font = ExtResource("2_3e0pq")
theme_override_font_sizes/font_size = 16
text = "TIME 0300"
max_lines_visible = 1
script = ExtResource("4_olqpy")

[node name="Spacer2" type="Control" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3

[node name="Stage" type="Label" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer"]
layout_mode = 2
theme_override_fonts/font = ExtResource("2_3e0pq")
theme_override_font_sizes/font_size = 16
text = "STAGE 01"
max_lines_visible = 1
script = ExtResource("3_wcg8v")

[node name="HBoxContainer2" type="HBoxContainer" parent="GUI/PanelContainer/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 0
theme_override_constants/separation = 0

[node name="VBoxContainer" type="VBoxContainer" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2"]
layout_mode = 2
theme_override_constants/separation = 0

[node name="HBoxContainer" type="HBoxContainer" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer"]
layout_mode = 2
theme_override_constants/separation = 8

[node name="Player" type="Label" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer/HBoxContainer"]
layout_mode = 2
theme_override_fonts/font = ExtResource("2_3e0pq")
theme_override_font_sizes/font_size = 16
text = "PLAYER"
max_lines_visible = 1

[node name="PlayerHealthBar" type="MarginContainer" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer/HBoxContainer" node_paths=PackedStringArray("timer", "remaining_hp")]
layout_mode = 2
theme_override_constants/margin_top = 1
script = ExtResource("4_hyd55")
timer = NodePath("Timer")
remaining_hp = NodePath("HBoxContainer/TextureRect")

[node name="HBoxContainer" type="HBoxContainer" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer/HBoxContainer/PlayerHealthBar"]
custom_minimum_size = Vector2(64, 0)
layout_mode = 2
size_flags_vertical = 4
theme_override_constants/separation = 0

[node name="TextureRect" type="TextureRect" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer/HBoxContainer/PlayerHealthBar/HBoxContainer"]
texture_repeat = 2
custom_minimum_size = Vector2(64, 6)
layout_mode = 2
size_flags_vertical = 4
texture = ExtResource("3_a2qj5")
expand_mode = 1
stretch_mode = 1

[node name="TextureRect2" type="TextureRect" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer/HBoxContainer/PlayerHealthBar/HBoxContainer"]
texture_repeat = 2
custom_minimum_size = Vector2(0, 6)
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 4
texture = ExtResource("4_ux4al")
expand_mode = 1
stretch_mode = 1

[node name="Timer" type="Timer" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer/HBoxContainer/PlayerHealthBar"]
wait_time = 0.133

[node name="HBoxContainer2" type="HBoxContainer" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer"]
layout_mode = 2
theme_override_constants/separation = 8

[node name="Enemy" type="Label" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer/HBoxContainer2"]
layout_mode = 2
theme_override_fonts/font = ExtResource("2_3e0pq")
theme_override_font_sizes/font_size = 16
text = "ENEMY "
max_lines_visible = 1

[node name="EnemyHealthBar" type="MarginContainer" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer/HBoxContainer2" node_paths=PackedStringArray("timer", "remaining_hp")]
layout_mode = 2
theme_override_constants/margin_top = 1
script = ExtResource("4_hyd55")
timer = NodePath("Timer")
remaining_hp = NodePath("HBoxContainer/TextureRect")

[node name="HBoxContainer" type="HBoxContainer" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer/HBoxContainer2/EnemyHealthBar"]
custom_minimum_size = Vector2(64, 0)
layout_mode = 2
size_flags_vertical = 4
theme_override_constants/separation = 0

[node name="TextureRect" type="TextureRect" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer/HBoxContainer2/EnemyHealthBar/HBoxContainer"]
texture_repeat = 2
custom_minimum_size = Vector2(64, 6)
layout_mode = 2
size_flags_vertical = 4
texture = ExtResource("5_ip3yo")
expand_mode = 1
stretch_mode = 1

[node name="TextureRect2" type="TextureRect" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer/HBoxContainer2/EnemyHealthBar/HBoxContainer"]
texture_repeat = 2
custom_minimum_size = Vector2(0, 6)
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 4
texture = ExtResource("4_ux4al")
expand_mode = 1
stretch_mode = 1

[node name="Timer" type="Timer" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer/HBoxContainer2/EnemyHealthBar"]
wait_time = 0.133

[node name="Spacer" type="Control" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2"]
layout_mode = 2
size_flags_horizontal = 3

[node name="MarginContainer" type="MarginContainer" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2"]
layout_mode = 2
theme_override_constants/margin_top = 0

[node name="SubweaponContainer" type="TextureRect" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/MarginContainer"]
layout_mode = 2
texture = ExtResource("6_qm5vt")

[node name="TextureRect" type="TextureRect" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/MarginContainer/SubweaponContainer"]
visible = false
layout_mode = 0
offset_left = 8.0
offset_top = 3.0
offset_right = 24.0
offset_bottom = 19.0
texture = ExtResource("7_l4l51")
stretch_mode = 2

[node name="Spacer2" type="Control" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2"]
layout_mode = 2
size_flags_horizontal = 3

[node name="VBoxContainer2" type="VBoxContainer" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2"]
layout_mode = 2
theme_override_constants/separation = 0

[node name="HBoxContainer" type="HBoxContainer" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer2"]
layout_mode = 2
theme_override_constants/separation = 0

[node name="TextureRect" type="TextureRect" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer2/HBoxContainer"]
layout_mode = 2
size_flags_vertical = 8
texture = ExtResource("7_5hip0")
stretch_mode = 2

[node name="Hearts" type="Label" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer2/HBoxContainer"]
layout_mode = 2
theme_override_fonts/font = ExtResource("2_3e0pq")
theme_override_font_sizes/font_size = 16
text = "-00"
script = ExtResource("13_plm4k")

[node name="Lives" type="Label" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer2"]
layout_mode = 2
theme_override_fonts/font = ExtResource("2_3e0pq")
theme_override_font_sizes/font_size = 16
text = "P-00"
script = ExtResource("14_5i80s")

[node name="Spacer3" type="Control" parent="GUI/PanelContainer/VBoxContainer/HBoxContainer2"]
layout_mode = 2
size_flags_horizontal = 3

[node name="Game Over" parent="GUI" instance=ExtResource("15_jld33")]
process_mode = 4
visible = false

[node name="FullBlackout" type="ColorRect" parent="GUI"]
process_mode = 3
visible = false
offset_right = 384.0
offset_bottom = 216.0
color = Color(0, 0, 0, 1)

[node name="Camera" type="Camera2D" parent="."]

[node name="MusicPlayer" type="AudioStreamPlayer" parent="."]
process_mode = 3

[node name="DebugWindow" type="Window" parent="."]
process_mode = 3
transparent_bg = true
mode = 1
initial_position = 1
size = Vector2i(768, 432)
visible = false
transient = true

[node name="Camera2D" type="Camera2D" parent="DebugWindow"]

[node name="TimeTimer" type="Timer" parent="."]
process_callback = 0

[node name="DeathTimer" type="Timer" parent="."]
process_callback = 0
wait_time = 1.6
one_shot = true

[node name="BlackScreenTimer" type="Timer" parent="."]
process_callback = 0
wait_time = 0.383
one_shot = true

[node name="ShortBlackScreenTimer" type="Timer" parent="."]
process_callback = 0
wait_time = 0.13
one_shot = true

[connection signal="hearts_changed" from="." to="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer2/HBoxContainer/Hearts" method="_hearts_changed"]
[connection signal="lives_changed" from="." to="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer2/Lives" method="_lives_changed"]
[connection signal="player_hp_changed" from="." to="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer/HBoxContainer/PlayerHealthBar" method="_hp_changed"]
[connection signal="score_changed" from="." to="GUI/PanelContainer/VBoxContainer/HBoxContainer/Score" method="_score_changed"]
[connection signal="stage_changed" from="." to="GUI/PanelContainer/VBoxContainer/HBoxContainer/Stage" method="update_label"]
[connection signal="time_left_changed" from="." to="GUI/PanelContainer/VBoxContainer/HBoxContainer/Time" method="_time_changed"]
[connection signal="timeout" from="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer/HBoxContainer/PlayerHealthBar/Timer" to="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer/HBoxContainer/PlayerHealthBar" method="_update_hp_display"]
[connection signal="timeout" from="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer/HBoxContainer2/EnemyHealthBar/Timer" to="GUI/PanelContainer/VBoxContainer/HBoxContainer2/VBoxContainer/HBoxContainer2/EnemyHealthBar" method="_update_hp_display"]
[connection signal="continue_game" from="GUI/Game Over" to="." method="_on_continue_game"]
[connection signal="end_game" from="GUI/Game Over" to="." method="_on_end_game"]
[connection signal="close_requested" from="DebugWindow" to="." method="_on_debug_window_close_requested"]
[connection signal="timeout" from="TimeTimer" to="." method="_on_time_timer_timeout"]
[connection signal="timeout" from="DeathTimer" to="." method="_on_death_timer_timeout"]
[connection signal="timeout" from="BlackScreenTimer" to="." method="_on_black_screen_timer_timeout"]
[connection signal="timeout" from="ShortBlackScreenTimer" to="." method="_on_short_black_screen_timer_timeout"]
